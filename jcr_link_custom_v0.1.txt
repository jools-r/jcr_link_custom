# Name: jcr_link_custom v0.1 
# Type: Admin/Public plugin
# Adds a custom field to the links panel
# Author: jcr / txpbuilders
# URL: http://txp.builders
# Recommended load order: 5

# .....................................................................
# This is a plugin for Textpattern CMS - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# .....................................................................

YToxNTp7czo0OiJuYW1lIjtzOjE1OiJqY3JfbGlua19jdXN0b20iO3M6NzoidmVyc2lvbiI7
czozOiIwLjEiO3M6ODoicmV2aXNpb24iO3M6MDoiIjtzOjY6ImF1dGhvciI7czoxNzoiamNy
IC8gdHhwYnVpbGRlcnMiO3M6MTA6ImF1dGhvcl91cmkiO3M6MTk6Imh0dHA6Ly90eHAuYnVp
bGRlcnMiO3M6MTE6ImRlc2NyaXB0aW9uIjtzOjM4OiJBZGRzIGEgY3VzdG9tIGZpZWxkIHRv
IHRoZSBsaW5rcyBwYW5lbCI7czo1OiJvcmRlciI7czoxOiI1IjtzOjQ6InR5cGUiO3M6MToi
MSI7czo1OiJmbGFncyI7czowOiIiO3M6ODoidGV4dHBhY2siO3M6OTc6IiNAYWRtaW4KI0Bs
YW5ndWFnZSBlbi1nYgpqY3JfbGlua19jdXN0b20gPT4gSW1hZ2UgSUQKI0BsYW5ndWFnZSBk
ZS1kZQpqY3JfbGlua19jdXN0b20gPT4gQmlsZCBJRAoiO3M6MTA6ImxvYWRfb3JkZXIiO3M6
MToiNSI7czo0OiJoZWxwIjtzOjI5MTI6IjxoMT5qY3JfbGlua19jdXN0b208L2gxPgoKPHA+
QWRkcyBhIHNpbmdsZSBleHRyYSBjdXN0b20gZmllbGQgb2YgdXAgdG8gMjU1IGNoYXJhY3Rl
cnMgdG8gdGhlIDxhIGhyZWY9Imh0dHA6Ly9kb2NzLnRleHRwYXR0ZXJuLmlvL2FkbWluaXN0
cmF0aW9uL2xpbmtzLXBhbmVsIj5BZG1pbiDigLogTGlua3M8L2E+IHBhbmVsIGFuZCBwcm92
aWRlcyBhIGNvcnJlc3BvbmRpbmcgdGFnIHRvIG91dHB1dCB0aGUgY3VzdG9tIGZpZWxkLjwv
cD4KCgo8aDI+VXNlIGNhc2VzPC9oMj4KCjxwPlVzZSB3aGVuZXZlciBleHRyYSBpbmZvcm1h
dGlvbiBuZWVkcyB0byBiZSBzdG9yZWQgd2l0aCBhIGxpbmsuIEZvciBleGFtcGxlOjwvcD4K
Cjx1bD4KCTxsaT5TdG9yZSBhIHR4cCBpbWFnZSBJRCBudW1iZXIgYW5kIHVzZSBpdCB0byBh
dHRhY2ggYSBsb2dvIHRvIGEgbGluay48L2xpPgoJPGxpPlN0b3JlIGFzc29jaWF0ZWQgZGV0
YWlscywgZm9yIGV4YW1wbGUgdGhlIGxvY2F0aW9uIG9mIGEgbGlua2VkIG9yZ2FuaXNhdGlv
bi48L2xpPgoJPGxpPuKApjwvbGk+CjwvdWw+CgoKPGgyIGlkPSJpbnN0YWxsYXRpb24iPklu
c3RhbGxhdGlvbjwvaDI+Cgo8cD5QYXN0ZSB0aGUgY29kZSBpbnRvIHRoZSAgPGVtPkFkbWlu
IOKAuiBQbHVnaW5zPC9lbT4gcGFuZWwsIGluc3RhbGwgYW5kIGVuYWJsZSB0aGUgcGx1Z2lu
LjwvcD4KCgo8aDIgaWQ9InRhZ3MiPlRhZ3M8L2gyPgoKPHByZT48Y29kZT4mbHQ7dHhwOmpj
cl9saW5rX2N1c3RvbSAvJmd0OzwvY29kZT48L3ByZT4KCjxwPk91dHB1dHMgdGhlIGNvbnRl
bnQgb2YgdGhlIGxpbmsgY3VzdG9tIGZpZWxkLjwvcD4KCjxoMz5UYWcgYXR0cmlidXRlczwv
aDM+Cgo8cD48c3Ryb25nPmVzY2FwZTwvc3Ryb25nPjxiciAvPgpFc2NhcGUgPHNwYW4gY2xh
c3M9ImNhcHMiPkhUTUw8L3NwYW4+IGVudGl0aWVzIHN1Y2ggYXMgPGNvZGU+Jmx0OzwvY29k
ZT4sIDxjb2RlPiZndDs8L2NvZGU+IGFuZCA8Y29kZT4mYW1wOzwvY29kZT4gcHJpb3IgdG8g
ZWNob2luZyB0aGUgZmllbGQgY29udGVudHMuPGJyIC8+CkV4YW1wbGU6IFVzZSA8Y29kZT5l
c2NhcGU9JnF1b3Q7JnF1b3Q7PC9jb2RlPiB0byBzdXBwcmVzcyBjb252ZXJzaW9uLiBEZWZh
dWx0OiA8Y29kZT5odG1sPC9jb2RlPi48L3A+CgoKPGgyIGlkPSJleGFtcGxlcyI+RXhhbXBs
ZTwvaDI+Cgo8cD5Qcm9kdWNlIGEgbGlzdCBvZiBsaW5rZWQgcGFydG5lciBsb2dvcyAoZnJv
bSBsaW5rIGFzc2lnbmVkIHRvIHRoZSBsaW5rIGNhdGVnb3J5ICYjODIyMDtwYXJ0bmVycyYj
ODIyMTspOjwvcD4KCjxwcmU+PGNvZGU+Jmx0O3R4cDpsaW5rbGlzdCB3cmFwdGFnPSZxdW90
O3VsJnF1b3Q7IGJyZWFrPSZxdW90O2xpJnF1b3Q7IGNhdGVnb3J5PSZxdW90O3BhcnRuZXJz
JnF1b3Q7Jmd0OwogICZsdDthIGhyZWY9JnF1b3Q7Jmx0O3R4cDpsaW5rX3VybCAvJmd0OyZx
dW90OyB0aXRsZT0mcXVvdDsmbHQ7dHhwOmxpbmtfbmFtZSAvJmd0OyZxdW90OyZndDsmbHQ7
dHhwOmltYWdlIGlkPSYjMzk7Jmx0O3R4cDpqY3JfbGlua19jdXN0b20gLyZndDsmIzM5OyAv
Jmd0OyZsdDsvYSZndDsKJmx0Oy90eHA6bGlua2xpc3QmZ3Q7PC9jb2RlPjwvcHJlPgoKPHA+
d2hlbiB0aGUgbGluayBjdXN0b20gZmllbGQgaXMgdXNlZCB0byBzdG9yZSB0aGUgSW1hZ2Ug
SUQjIG9mIHRoZSBsb2dvLjwvcD4KCgo8aDI+Q2hhbmdpbmcgdGhlIGxhYmVsIG9mIHRoZSBj
dXN0b20gZmllbGQ8L2gyPgoKPHA+VGhlIG5hbWUgb2YgY3VzdG9tIGZpZWxkIGNhbiBiZSBj
aGFuZ2VkIGJ5IHNwZWNpZnlpbmcgYSBuZXcgbGFiZWwgdXNpbmcgdGhlIDxlbT5JbnN0YWxs
IGZyb20gVGV4dHBhY2s8L2VtPiBmaWVsZCBpbiB0aGUgPGEgaHJlZj0iaHR0cDovL2RvY3Mu
dGV4dHBhdHRlcm4uaW8vYWRtaW5pc3RyYXRpb24vbGFuZ3VhZ2VzLXBhbmVsLmh0bWwiPkFk
bWluIOKAuiBMYW5ndWFnZXM8L2E+IHBhbmVsLiBFbnRlciB5b3VyIG93biBpbmZvcm1hdGlv
biBpbiB0aGUgZm9sbG93aW5nIHBhdHRlcm4gYW5kIGNsaWNrIDxzdHJvbmc+VXBsb2FkPC9z
dHJvbmc+OjwvcD4KCjxwcmU+PGNvZGU+I0BhZG1pbgojQGxhbmd1YWdlIGVuLWdiCmpjcl9s
aW5rX2N1c3RvbSA9Jmd0OyBJbWFnZSBJRDwvY29kZT48L3ByZT4KCjxwPnJlcGxhY2luZyA8
Y29kZT5lbi1nYjwvY29kZT4gd2l0aCB5b3VyIG93biBsYW5ndWFnZSBhbmQgPGNvZGU+SW1h
Z2UgSUQ8L2NvZGU+IHdpdGggeW91ciBvd24gZGVzaXJlZCBsYWJlbC48L3A+CgoKPGgyIGlk
PSJkZWluc3RhbGxhdGlvbiI+RGUtaW5zdGFsbGF0aW9uPC9oMj4KCjxwPlRoZSBwbHVnaW4g
Y2xlYW5zIHVwIGFmdGVyIGl0c2VsZjogZGVpbnN0YWxsaW5nIHRoZSBwbHVnaW4gcmVtb3Zl
cyB0aGUgZXh0cmEgY29sdW1uIGZyb20gdGhlIGRhdGFiYXNlLiBUbyBzdG9wIHVzaW5nIHRo
ZSBwbHVnaW4gYnV0IGtlZXAgdGhlIGRhdGFiYXNlIHRhYmxlcywganVzdCBkaXNhYmxlIChk
ZWFjdGl2YXRlKSB0aGUgcGx1Z2luIGJ1dCBkb24mIzgyMTc7dCBkZWxldGUgaXQuPC9wPgoK
CjxoMiBpZD0iY2hhbmdlbG9nIj5DaGFuZ2Vsb2c8L2gyPgoKPGgzPlZlcnNpb24gMC4xIOKA
kyAyMDE2LzAzLzA0PC9oMz4KCjx1bD4KCTxsaT5GaXJzdCByZWxlYXNlPC9saT4KPC91bD4K
Cgo8aDIgaWQ9ImNyZWRpdHMiPkNyZWRpdHM8L2gyPgoKPHA+Um9iZXJ0IFdldHpsbWF5cuKA
mXMgPGEgaHJlZj0iaHR0cHM6Ly9naXRodWIuY29tL3J3ZXR6bG1heXIvd2V0X3Byb2ZpbGUi
PndldF9wcm9maWxlPC9hPiBwbHVnaW4gZm9yIHRoZSBzdGFydGluZyBwb2ludCwgYW5kIGZ1
cnRoZXIgZXhhbXBsZXMgYnkgPGEgaHJlZj0iaHR0cDovL3d3dy5zdGVmZGF3c29uLmNvbSI+
U3RlZiBEYXdzb248L2E+IGFuZCA8YSBocmVmPSJodHRwczovL2dpdGh1Yi5jb20vZ29jb20i
Pkp1a2thIFN2YWhuPC9hPi48L3A+IjtzOjM6ImNzcyI7czowOiIiO3M6NDoiY29kZSI7czoy
Njc0OiJjbGFzcyBqY3JfbGlua19jdXN0b20KewoJLyoqCgkgKiBJbml0aWFsaXNlLgoJICov
CgkgZnVuY3Rpb24gX19jb25zdHJ1Y3QoKQoJewoJCXJlZ2lzdGVyX2NhbGxiYWNrKGFycmF5
KF9fQ0xBU1NfXywgJ2xpZmVjeWNsZScpLCAncGx1Z2luX2xpZmVjeWNsZS5qY3JfbGlua19j
dXN0b20nKTsKCQlyZWdpc3Rlcl9jYWxsYmFjayhhcnJheShfX0NMQVNTX18sICd1aScpLCAn
bGlua191aScsICdleHRlbmRfZGV0YWlsX2Zvcm0nKTsKCQlyZWdpc3Rlcl9jYWxsYmFjayhh
cnJheShfX0NMQVNTX18sICdzYXZlJyksICdsaW5rJywgJ2xpbmtfc2F2ZScpOwoJfQoKICAv
KioKICAgKiBBZGQgYW5kIHJlbW92ZSBjdXN0b20gZmllbGQgZnJvbSB0eHBfbGluayB0YWJs
ZS4KICAgKgogICAqIEBwYXJhbSAkZXZlbnQgc3RyaW5nCiAgICogQHBhcmFtICRzdGVwIHN0
cmluZyAgVGhlIGxpZmVjeWNsZSBwaGFzZSBvZiB0aGlzIHBsdWdpbgogICAqLwogIHB1Ymxp
YyBzdGF0aWMgZnVuY3Rpb24gbGlmZWN5Y2xlKCRldmVudCwgJHN0ZXApCiAgewogICAgICBz
d2l0Y2ggKCRzdGVwKSB7CiAgICAgICAgICBjYXNlICdlbmFibGVkJzoKICAgICAgICAgICAg
ICBicmVhazsKICAgICAgICAgIGNhc2UgJ2Rpc2FibGVkJzoKICAgICAgICAgICAgICBicmVh
azsKICAgICAgICAgIGNhc2UgJ2luc3RhbGxlZCc6CiAgICAgICAgICAgICAgc2FmZV9hbHRl
cigKICAgICAgICAgICAgICAgICd0eHBfbGluaycsCiAgICAgICAgICAgICAgICAnQUREIENP
TFVNTiBqY3JfbGlua19jdXN0b20gVkFSQ0hBUigyNTUpIE5VTEwgQUZURVIgYXV0aG9yJwog
ICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICdk
ZWxldGVkJzoKICAgICAgICAgICAgICBzYWZlX2FsdGVyKAogICAgICAgICAgICAgICAgJ3R4
cF9saW5rJywKICAgICAgICAgICAgICAgICdEUk9QIENPTFVNTiBqY3JfbGlua19jdXN0b20n
CiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgfQogICAgICBy
ZXR1cm47CiAgfQoKCS8qKgoJICogUGFpbnQgYWRkaXRpb25hbCBmaWVsZHMgZm9yIGxpbmsg
Y3VzdG9tIGZpZWxkCgkgKgoJICogQHBhcmFtICRldmVudCBzdHJpbmcKCSAqIEBwYXJhbSAk
c3RlcCBzdHJpbmcKCSAqIEBwYXJhbSAkZHVtbXkgc3RyaW5nCgkgKiBAcGFyYW0gJHJzIGFy
cmF5IFRoZSBjdXJyZW50IGxpbmsncyBkYXRhCgkgKiBAcmV0dXJuIHN0cmluZwoJICovCglw
dWJsaWMgc3RhdGljIGZ1bmN0aW9uIHVpKCRldmVudCwgJHN0ZXAsICRkdW1teSwgJHJzKQoJ
ewoJCWV4dHJhY3QobEF0dHMoYXJyYXkoCgkJCSdqY3JfbGlua19jdXN0b20nID0+ICcnCgkJ
KSwgJHJzLCAwKSk7CgoJCXJldHVybgoJCQlpbnB1dExhYmVsKCdqY3JfbGlua19jdXN0b20n
LCBmSW5wdXQoJ3RleHQnLCAnamNyX2xpbmtfY3VzdG9tJywgJGpjcl9saW5rX2N1c3RvbSwg
JycsICcnLCAnJywgSU5QVVRfUkVHVUxBUiwgJycsICdqY3JfbGlua19jdXN0b20nKSwgJ2pj
cl9saW5rX2N1c3RvbScpLm47Cgl9CgoJLyoqCgkgKiBTYXZlIGFkZGl0aW9uYWwgbGluayBj
dXN0b20gZmllbGRzCgkgKgoJICogQHBhcmFtICRldmVudCBzdHJpbmcKCSAqIEBwYXJhbSAk
c3RlcCBzdHJpbmcKCSAqLwoJcHVibGljIHN0YXRpYyBmdW5jdGlvbiBzYXZlKCRldmVudCwg
JHN0ZXApCgl7CgkJZXh0cmFjdChkb1NsYXNoKHBzYShhcnJheSgnamNyX2xpbmtfY3VzdG9t
JywgJ2lkJykpKSk7CgkJJGlkID0gYXNzZXJ0X2ludCgkaWQpOwoJCXNhZmVfdXBkYXRlKCd0
eHBfbGluaycsCgkJICAiamNyX2xpbmtfY3VzdG9tID0gJyRqY3JfbGlua19jdXN0b20nIiwK
CQkJImlkID0gJGlkIgoJCSk7Cgl9Cn0KCmlmICh0eHBpbnRlcmZhY2UgPT09ICdhZG1pbicp
IHsKCiAgICBuZXcgamNyX2xpbmtfY3VzdG9tOwoKfSBlbHNlaWYgKHR4cGludGVyZmFjZSA9
PT0gJ3B1YmxpYycpIHsKCiAgICBpZiAoY2xhc3NfZXhpc3RzKCdcVGV4dHBhdHRlcm5cVGFn
XFJlZ2lzdHJ5JykpIHsKICAgICAgICBUeHA6OmdldCgnXFRleHRwYXR0ZXJuXFRhZ1xSZWdp
c3RyeScpCiAgICAgICAgICAgIC0+cmVnaXN0ZXIoJ2pjcl9saW5rX2N1c3RvbScpOwogICAg
fQoKfQoKICAvKioKICAgKiBQdWJsaWMgdGFnOiBzaG93IGN1c3RvbSBsaW5rIGZpZWxkCiAg
ICogQHBhcmFtICBzdHJpbmcgJGF0dHNbZXNjYXBlXSBDb252ZXJ0IHNwZWNpYWwgY2hhcmFj
dGVycyB0byBIVE1MIGVudGl0aWVzLgogICAqIEByZXR1cm4gc3RyaW5nICBjdXN0b20gZmll
bGQgb3V0cHV0CiAgICogPGNvZGU+CiAgICogICAgICAgIDx0eHA6amNyX2xpbmtfY3VzdG9t
IGVzY2FwZT0iaHRtbCIgLz4KICAgKiA8L2NvZGU+CiAgICovCgogICAgZnVuY3Rpb24gamNy
X2xpbmtfY3VzdG9tKCRhdHRzKQogICAgewogICAgICAgIGdsb2JhbCAkdGhpc2xpbms7Cgog
ICAgICAgIGFzc2VydF9saW5rKCk7CgogICAgICAgIGV4dHJhY3QobEF0dHMoYXJyYXkoCiAg
ICAgICAgICAgICdlc2NhcGUnID0+ICdodG1sJywKICAgICAgICApLCAkYXR0cykpOwoKICAg
ICAgICByZXR1cm4gKCRlc2NhcGUgPT0gJ2h0bWwnKQogICAgICAgICAgICA/IHR4cHNwZWNp
YWxjaGFycygkdGhpc2xpbmtbJ2pjcl9saW5rX2N1c3RvbSddKQogICAgICAgICAgICA6ICR0
aGlzbGlua1snamNyX2xpbmtfY3VzdG9tJ107CiAgICB9IjtzOjM6Im1kNSI7czozMjoiMDRj
NDY1Zjc1NDY0YWMzOTQ3MzgzYmRkYmNlMjRhMzUiO30=
